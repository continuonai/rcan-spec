---
import BaseLayout from '../../layouts/BaseLayout.astro';
---

<BaseLayout title="API Documentation" description="RCAN Robot Registry API - Programmatic access to robot data">
  <h1>API Documentation</h1>
  <p class="lead">Access the RCAN Robot Registry programmatically using our JSON API.</p>

  <section class="api-section">
    <h2>Base URL</h2>
    <code class="base-url">https://rcan.dev/api</code>
  </section>

  <section class="api-section">
    <h2>Authentication</h2>
    <p>No authentication required. The API is publicly accessible and read-only.</p>
  </section>

  <section class="api-section">
    <h2>Rate Limits</h2>
    <p>No rate limits are currently enforced. Please be respectful and cache responses when possible.</p>
  </section>

  <section class="api-section">
    <h2>Endpoints</h2>

    <article class="endpoint">
      <div class="endpoint-header">
        <span class="method get">GET</span>
        <code class="path">/api/robots.json</code>
      </div>
      <p>List all registered robots with optional filtering and pagination.</p>

      <h4>Query Parameters</h4>
      <table>
        <thead>
          <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>status</code></td>
            <td>string</td>
            <td>Filter by status: <code>active</code>, <code>retired</code>, <code>prototype</code>, <code>concept</code></td>
          </tr>
          <tr>
            <td><code>manufacturer</code></td>
            <td>string</td>
            <td>Filter by manufacturer name (case-insensitive, partial match)</td>
          </tr>
          <tr>
            <td><code>tag</code></td>
            <td>string</td>
            <td>Filter by tag (exact match, case-insensitive)</td>
          </tr>
          <tr>
            <td><code>limit</code></td>
            <td>integer</td>
            <td>Maximum number of results to return</td>
          </tr>
          <tr>
            <td><code>offset</code></td>
            <td>integer</td>
            <td>Number of results to skip (for pagination)</td>
          </tr>
        </tbody>
      </table>

      <h4>Example Request</h4>
      <pre><code>curl "https://rcan.dev/api/robots.json?status=active&limit=5"</code></pre>

      <h4>Example Response</h4>
      <pre><code>&#123;
  "success": true,
  "data": [
    &#123;
      "rrn": "RRN-00000001",
      "name": "TurtleBot 3 Burger",
      "manufacturer": "ROBOTIS",
      "model": "turtlebot3_burger",
      "description": "A compact, affordable mobile robot...",
      "status": "active",
      "tags": ["education", "mobile", "ros2"]
    &#125;
  ],
  "meta": &#123;
    "total": 10,
    "count": 5,
    "limit": 5,
    "offset": 0
  &#125;
&#125;</code></pre>
    </article>

    <article class="endpoint">
      <div class="endpoint-header">
        <span class="method get">GET</span>
        <code class="path">/api/robots/[rrn].json</code>
      </div>
      <p>Get detailed information about a specific robot by its RRN.</p>

      <h4>Path Parameters</h4>
      <table>
        <thead>
          <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>rrn</code></td>
            <td>string</td>
            <td>Robot Registration Number (e.g., <code>RRN-00000001</code>)</td>
          </tr>
        </tbody>
      </table>

      <h4>Example Request</h4>
      <pre><code>curl "https://rcan.dev/api/robots/RRN-00000001.json"</code></pre>

      <h4>Example Response</h4>
      <pre><code>&#123;
  "success": true,
  "data": &#123;
    "rrn": "RRN-00000001",
    "name": "TurtleBot 3 Burger",
    "manufacturer": "ROBOTIS",
    "model": "turtlebot3_burger",
    "description": "A compact, affordable mobile robot...",
    "image": "/robots/turtlebot3-burger.svg",
    "production_year": 2017,
    "status": "active",
    "urdf_url": "https://github.com/ROBOTIS-GIT/turtlebot3/...",
    "github_url": "https://github.com/ROBOTIS-GIT/turtlebot3",
    "website": "https://www.robotis.us/turtlebot-3/",
    "specs": &#123;
      "weight_kg": 1.0,
      "dimensions": "138 x 178 x 192 mm",
      "max_speed_mps": 0.22,
      "dof": 2,
      "ros_version": ["ROS 1", "ROS 2"],
      "sensors": ["LDS-01 LiDAR", "IMU", "Wheel Encoders"],
      "compute": "Raspberry Pi 4",
      "battery_life_hours": 2.5
    &#125;,
    "owner": &#123;
      "name": "Open Source Community",
      "type": "community",
      "website": "https://emanual.robotis.com/..."
    &#125;,
    "ruri": null,
    "submitted_by": "github:continuonai",
    "submitted_date": "2026-01-04",
    "tags": ["education", "mobile", "ros2", "lidar"]
  &#125;
&#125;</code></pre>

      <h4>Error Response (404)</h4>
      <pre><code>&#123;
  "success": false,
  "error": "Robot not found",
  "rrn": "RRN-99999999"
&#125;</code></pre>
    </article>

    <article class="endpoint">
      <div class="endpoint-header">
        <span class="method get">GET</span>
        <code class="path">/api/badge/[rrn].svg</code>
      </div>
      <p>Generate an SVG badge for a robot to embed in GitHub READMEs.</p>

      <h4>Query Parameters</h4>
      <table>
        <thead>
          <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>style</code></td>
            <td>string</td>
            <td>Badge style: <code>flat</code> (default), <code>flat-square</code>, <code>plastic</code></td>
          </tr>
          <tr>
            <td><code>label</code></td>
            <td>string</td>
            <td>Custom left-side label (default: "RCAN")</td>
          </tr>
        </tbody>
      </table>

      <h4>Example Usage</h4>
      <pre><code>&lt;!-- Markdown --&gt;
![RCAN](https://rcan.dev/api/badge/RRN-00000001.svg)

&lt;!-- HTML --&gt;
&lt;img src="https://rcan.dev/api/badge/RRN-00000001.svg" alt="RCAN Registry"&gt;</code></pre>
    </article>

    <article class="endpoint">
      <div class="endpoint-header">
        <span class="method get">GET</span>
        <code class="path">/api/qr/[rrn].svg</code>
      </div>
      <p>Generate a QR code linking to the robot's registry page.</p>

      <h4>Query Parameters</h4>
      <table>
        <thead>
          <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>size</code></td>
            <td>integer</td>
            <td>QR code size in pixels (default: 200, max: 1000)</td>
          </tr>
        </tbody>
      </table>

      <h4>Example Usage</h4>
      <pre><code>curl "https://rcan.dev/api/qr/RRN-00000001.svg?size=300"</code></pre>
    </article>
  </section>

  <section class="api-section">
    <h2>Response Format</h2>
    <p>All JSON responses follow a consistent format:</p>
    <pre><code>&#123;
  "success": boolean,      // true if request succeeded
  "data": object | array,  // response payload
  "meta": &#123;                // pagination info (list endpoints only)
    "total": number,
    "count": number,
    "limit": number | null,
    "offset": number
  &#125;,
  "error": string          // error message (only on failure)
&#125;</code></pre>
  </section>

  <section class="api-section">
    <h2>CORS</h2>
    <p>Cross-Origin Resource Sharing (CORS) is enabled for all origins. You can make API requests directly from browser-based applications.</p>
  </section>

  <section class="api-section">
    <h2>Caching</h2>
    <p>Responses include <code>Cache-Control: public, max-age=3600</code> headers. Data is regenerated on each site build, so caching for up to 1 hour is recommended.</p>
  </section>

  <section class="api-section">
    <h2>Code Examples</h2>

    <h3>JavaScript / TypeScript</h3>
    <pre><code>// Fetch all active robots
const response = await fetch('https://rcan.dev/api/robots.json?status=active');
const &#123; data: robots &#125; = await response.json();

// Fetch a specific robot
const robot = await fetch('https://rcan.dev/api/robots/RRN-00000001.json')
  .then(r =&gt; r.json())
  .then(r =&gt; r.data);

console.log(robot.name); // "TurtleBot 3 Burger"</code></pre>

    <h3>Python</h3>
    <pre><code>import requests

# Fetch all robots
response = requests.get('https://rcan.dev/api/robots.json')
robots = response.json()['data']

# Fetch by manufacturer
response = requests.get('https://rcan.dev/api/robots.json',
                       params=&#123;'manufacturer': 'ROBOTIS'&#125;)
robotis_robots = response.json()['data']</code></pre>

    <h3>cURL</h3>
    <pre><code># List all robots
curl https://rcan.dev/api/robots.json

# Filter by status and limit results
curl "https://rcan.dev/api/robots.json?status=active&amp;limit=5"

# Get specific robot
curl https://rcan.dev/api/robots/RRN-00000001.json</code></pre>
  </section>
</BaseLayout>

<style>
  .lead {
    font-size: 1.25rem;
    color: var(--color-text-muted);
    margin-bottom: 2rem;
  }

  .api-section {
    margin-bottom: 3rem;
  }

  .base-url {
    display: block;
    font-size: 1.25rem;
    padding: 1rem 1.5rem;
    background: var(--color-code-bg);
    border-radius: 8px;
    border: 1px solid var(--color-border);
  }

  .endpoint {
    background: var(--color-bg-alt);
    border: 1px solid var(--color-border);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .endpoint-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .method {
    font-size: 0.75rem;
    font-weight: 700;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    text-transform: uppercase;
  }

  .method.get {
    background: rgba(34, 197, 94, 0.2);
    color: #22c55e;
  }

  .endpoint-header .path {
    font-size: 1rem;
    background: transparent;
    padding: 0;
  }

  .endpoint h4 {
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
  }

  .endpoint table {
    margin: 0.5rem 0 1rem;
    font-size: 0.875rem;
  }

  .endpoint pre {
    margin: 0.5rem 0;
    font-size: 0.8rem;
  }

  h3 {
    margin-top: 1.5rem;
  }
</style>
